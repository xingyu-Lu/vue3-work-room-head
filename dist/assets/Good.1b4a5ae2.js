var E=Object.defineProperty,U=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var D=(e,t,o)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,S=(e,t)=>{for(var o in t||(t={}))R.call(t,o)&&D(e,o,t[o]);if(w)for(var o of w(t))j.call(t,o)&&D(e,o,t[o]);return e},V=(e,t)=>U(e,A(t));import{a as h}from"./axios.4d33b949.js";import{_ as P,h as T}from"./index.4c49b19c.js";import{r as I,a as N,t as G,c as u,d as p,e as v,w as d,h as $,f as a,ak as b,i as f,aD as q,u as B,o as x,ad as M,am as H,ae as z,af as L,an as J}from"./vendor.0774305f.js";const K={name:"DialogAddHotGood",props:{type:String,configType:Number,reload:Function},setup(e){const t=I(null),o=N({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],id:[{required:"true",message:"\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],sort:[{required:"true",message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),l=n=>{h.get(`/good_info.php?id=${n}`).then(m=>{o.ruleForm={name:m.goods.goodsName,id:m.goods.goodsId,link:m.goods.goodsCoverImg,sort:m.goods.stockNum}})},c=n=>{o.visible=!0,n?(o.id=n,l(n)):o.ruleForm={name:"",id:"",link:"",sort:""}},y=()=>{o.visible=!1},s=()=>{t.value.validate(n=>{if(n){if(T(o.ruleForm.name)||T(o.ruleForm.link)){b.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}if(o.ruleForm.name.length>128){b.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");return}if(o.ruleForm.sort<0||o.ruleForm.sort>200){b.error("\u6392\u5E8F\u503C\u4E0D\u80FD\u5C0F\u4E8E 0 \u6216\u5927\u4E8E 200");return}e.type=="add"?h.post("/indexConfigs",{configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{b.success("\u6DFB\u52A0\u6210\u529F"),o.visible=!1,e.reload&&e.reload()}):h.put("/indexConfigs",{configId:o.id,configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{b.success("\u4FEE\u6539\u6210\u529F"),o.visible=!1,e.reload&&e.reload()})}})};return V(S({},G(o)),{open:c,close:y,formRef:t,submitForm:s})}},O={class:"dialog-footer"},Q=f("\u53D6 \u6D88"),W=f("\u786E \u5B9A");function X(e,t,o,l,c,y){const s=u("el-input"),n=u("el-form-item"),m=u("el-form"),_=u("el-button"),k=u("el-dialog");return p(),v(k,{title:o.type=="add"?"\u6DFB\u52A0\u5546\u54C1":"\u4FEE\u6539\u5546\u54C1",modelValue:e.visible,"onUpdate:modelValue":t[5]||(t[5]=i=>e.visible=i)},{footer:d(()=>[$("span",O,[a(_,{onClick:t[4]||(t[4]=i=>e.visible=!1)},{default:d(()=>[Q]),_:1}),a(_,{type:"primary",onClick:l.submitForm},{default:d(()=>[W]),_:1},8,["onClick"])])]),default:d(()=>[a(m,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:d(()=>[a(n,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:d(()=>[a(s,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":t[0]||(t[0]=i=>e.ruleForm.name=i)},null,8,["modelValue"])]),_:1}),a(n,{label:"\u8DF3\u8F6C\u94FE\u63A5",prop:"link"},{default:d(()=>[a(s,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":t[1]||(t[1]=i=>e.ruleForm.link=i)},null,8,["modelValue"])]),_:1}),a(n,{label:"\u5546\u54C1\u7F16\u53F7",prop:"id"},{default:d(()=>[a(s,{type:"number",min:"0",modelValue:e.ruleForm.id,"onUpdate:modelValue":t[2]||(t[2]=i=>e.ruleForm.id=i)},null,8,["modelValue"])]),_:1}),a(n,{label:"\u6392\u5E8F\u503C",prop:"sort"},{default:d(()=>[a(s,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":t[3]||(t[3]=i=>e.ruleForm.sort=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}var Y=P(K,[["render",X]]);const Z={components:{Timer:q,DialogAddGood:Y},name:"Good",setup(){const e=I(null),t=I(null),o=B(),l=N({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:2,type:"add",configType:3});x(()=>{c()});const c=()=>{l.loading=!0,h.get("/good_list.php",{params:{pageNumber:l.currentPage,pageSize:l.pageSize}}).then(r=>{l.tableData=r.list,l.total=r.totalCount,l.currentPage=r.currPage,l.loading=!1})},y=()=>{o.push({path:"/add_good"})},s=r=>{o.push({path:"/add_good",query:{id:r}})},n=r=>{l.type="edit",e.value.open(r)},m=()=>{l.loading=!0,h.get("/good_list.php",{params:{pageNumber:l.currentPage,pageSize:l.pageSize}}).then(r=>{l.tableData=r.list,l.total=r.totalCount,l.currentPage=r.currPage,l.loading=!1})},_=r=>{l.multipleSelection=r},k=r=>{l.currentPage=r,c()},i=(r,C)=>{h.put(`/goods/status/${C}`,{ids:r?[r]:[]}).then(()=>{b.success("\u4FEE\u6539\u6210\u529F"),c()})};return V(S({},G(l)),{multipleTable:t,handleSelectionChange:_,handleAdd:y,handleEdit:s,getGoodList:c,changePage:k,handleStatus:i,Plus:M,getIndex:m,handleDialogEdit:n,addGood:e})}},ee={class:"header"},oe=f("\u65B0\u589E\u5546\u54C1"),le={key:0,style:{color:"green"}},te={key:1,style:{color:"red"}},ae=f("\u4FEE\u6539"),ne=f("dialog\u4FEE\u6539 "),re=f("\u4E0B\u67B6"),de=f("\u4E0A\u67B6 ");function se(e,t,o,l,c,y){const s=u("el-button"),n=u("el-table-column"),m=u("el-image"),_=u("el-table"),k=u("el-pagination"),i=u("el-card"),r=u("DialogAddGood"),C=H("loading");return p(),z(L,null,[a(i,{class:"good-container"},{header:d(()=>[$("div",ee,[a(s,{type:"primary",size:"small",icon:l.Plus,onClick:l.handleAdd},{default:d(()=>[oe]),_:1},8,["icon","onClick"])])]),default:d(()=>[J((p(),v(_,{size:"small",ref:"multipleTable",stripe:"",data:e.tableData,"tooltip-effect":"dark",onSelectionChange:l.handleSelectionChange},{default:d(()=>[a(n,{type:"selection",width:"55"}),a(n,{prop:"goodsId",label:"\u5546\u54C1\u7F16\u53F7"}),a(n,{prop:"goodsName",label:"\u5546\u54C1\u540D"}),a(n,{prop:"goodsIntro",label:"\u5546\u54C1\u7B80\u4ECB"}),a(n,{label:"\u5546\u54C1\u56FE\u7247"},{default:d(g=>[(p(),v(m,{src:g.row.goodsCoverImg,key:g.row.goodsId,alt:"\u56FE\u7247",lazy:!0},null,8,["src"]))]),_:1}),a(n,{prop:"stockNum",label:"\u5546\u54C1\u5E93\u5B58"}),a(n,{prop:"sellingPrice",label:"\u5546\u54C1\u552E\u4EF7"}),a(n,{label:"\u4E0A\u67B6\u72B6\u6001"},{default:d(g=>[g.row.goodsSellStatus==0?(p(),z("span",le,"\u9500\u552E\u4E2D")):(p(),z("span",te,"\u5DF2\u4E0B\u67B6"))]),_:1}),a(n,{label:"\u64CD\u4F5C",width:"200"},{default:d(g=>[a(s,{type:"text",size:"small",onClick:F=>l.handleEdit(g.row.goodsId)},{default:d(()=>[ae]),_:2},1032,["onClick"]),a(s,{type:"text",size:"small",onClick:F=>l.handleDialogEdit(g.row.goodsId)},{default:d(()=>[ne]),_:2},1032,["onClick"]),g.row.goodsSellStatus==0?(p(),v(s,{key:0,type:"text",size:"small",onClick:F=>l.handleStatus(g.row.goodsId,1)},{default:d(()=>[re]),_:2},1032,["onClick"])):(p(),v(s,{key:1,type:"text",size:"small",onClick:F=>l.handleStatus(g.row.goodsId,0)},{default:d(()=>[de]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data","onSelectionChange"])),[[C,e.loading]]),a(k,{style:{"margin-top":"20px"},background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:l.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1}),a(r,{ref:"addGood",reload:l.getIndex,type:e.type,configType:e.configType},null,8,["reload","type","configType"])],64)}var ce=P(Z,[["render",se],["__scopeId","data-v-053e809c"]]);export{ce as default};

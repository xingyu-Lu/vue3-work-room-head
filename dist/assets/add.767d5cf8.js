var W=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(t,l,m)=>l in t?W(t,l,{enumerable:!0,configurable:!0,writable:!0,value:m}):t[l]=m,O=(t,l)=>{for(var m in l||(l={}))Z.call(l,m)&&B(t,m,l[m]);if(A)for(var m of A(l))$.call(l,m)&&B(t,m,l[m]);return t},I=(t,l)=>X(t,Y(l));import{ad as ee,ao as oe,r as N,al as te,u as le,a as ae,ap as ne,ak as c,o as re,aq as se,t as ie,c as r,d as F,ae as v,f as o,w as a,af as de,h as y,ah as D,g as S,i as p}from"./vendor.0774305f.js";import{a as M,B as me,E as ue,T as ce}from"./index.esm.5c925475.js";import{a as k}from"./axios.4d33b949.js";import{_ as fe,l as q,u as T,d as pe}from"./index.4c49b19c.js";function _e(t,l){const{link:m="",fileName:i=""}=t;return`<a data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline data-link="${m}" data-fileName="${i}" href="${m}" target="_blank">${i}</a>`}const ge={type:"attachment",elemToHtml:_e};M.elemsToHtml=[ge];me.registerModule(M);const he={name:"news_add",components:{Plus:ee,Delete:oe,Editor:ue,Toolbar:ce},setup(){N(null);const t=N(null),l=N(null),m=te(),i=le(),{id:f,office_id:V}=m.query,s=ae({res_data:"",token:"Bearer "+q("token")||"",id:f,Form:{img_url:"",img:"",name:"",professional:"",excel:"",content:"",sort:"",status:"0",disabled:!0,fileList:[]},rules:{img:[{required:!0,message:"\u56FE\u7247\u5FC5\u987B",trigger:["change"]}],name:[{required:!0,message:"\u59D3\u540D\u5FC5\u987B",trigger:["change"]}],professional:[{required:!1,message:"\u804C\u79F0\u5FC5\u987B",trigger:["change"]}],excel:[{required:!1,message:"\u64C5\u957F\u5FC5\u987B",trigger:["change"]}],sort:[{required:!1,message:"\u6392\u5E8F\u5FC5\u987B",trigger:["change"]}],status:[{required:!0,message:"\u72B6\u6001\u5FC5\u987B",trigger:["change"]}]}}),_=ne(),g={insertKeys:{index:31,keys:["uploadAttachment"]}},C={placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9...",hoverbarKeys:{attachment:{menuKeys:["downloadAttachment"]}},MENU_CONF:{uploadImage:{server:T,fieldName:"file",maxFileSize:2*1024*1024,maxNumberOfFiles:10,allowedFileTypes:["image/*"],meta:{basket:"img"},headers:{Authorization:s.token},customInsert:function(e,n){n(e.data.src,e.data.file_name,e.data.src)},onError(e,n,d){c.error(new Error(n).message),console.log(e,n,d)}},uploadVideo:{server:T,fieldName:"file",maxFileSize:100*1024*1024,allowedFileTypes:["video/*"],meta:{basket:"video"},headers:{Authorization:s.token},customInsert:function(e,n){n(e.data.src)},onError(e,n,d){c.error(new Error(n).message),console.log(e,n,d)}},uploadAttachment:{server:T,fieldName:"file",maxFileSize:10*1024*1024,meta:{basket:"attachment"},headers:{Authorization:s.token},customInsert:function(e,n,d){d(`${n.name}`,e.data.src)},onError(e,n,d){c.error(new Error(n).message),console.log(e,n,d)}}}},w=e=>{_.value=e};re(()=>{f&&k.get(`/api/head/technicalOfficeDoctors/${f}`).then(e=>{s.Form={img_url:e.data.url||"",img:e.data.file_id,name:e.data.name,professional:e.data.professional,excel:e.data.excel,content:e.data.content,sort:e.data.sort,status:String(e.data.status),fileList:[{url:e.data.url}],disabled:!0}}),q("userinfo")?s.res_data=q("userinfo"):x()}),se(()=>{const e=_.value;e!=null&&e.destroy()});const x=()=>{k.get("/api/head/staffs/info").then(e=>{s.res_data=e.data,localSet("userinfo",e.data)})},E=()=>{t.value.validate(e=>{if(e){let n=k.post,d={img:s.Form.img,name:s.Form.name,professional:s.Form.professional,excel:s.Form.excel,content:s.Form.content,sort:s.Form.sort,status:s.Form.status},b="/api/head/technicalOfficeDoctors";f&&(n=k.put,b=`/api/head/technicalOfficeDoctors/${f}`),n(b,d).then(()=>{f?c.success("\u4FEE\u6539\u6210\u529F"):c.success("\u6DFB\u52A0\u6210\u529F"),i.push({path:"/kssz-ksys-index",query:{id:V}})})}})},z=e=>{if((e.size/1024/1024).toFixed(2)>1)return c.error("\u4E0A\u4F20\u7684\u56FE\u7247\u5927\u4E8E1\u5146"),!1;const d=e.name.split(".")[1]||"";if(!["jpg","jpeg","png","gif"].includes(d))return c.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png\u3001gif \u683C\u5F0F\u7684\u56FE\u7247"),!1},h=e=>{c.success("\u4E0A\u4F20\u6210\u529F"),s.Form.img_url=e.data.src||"",s.Form.img=e.data.id||""},U=e=>{c.error("\u4E0A\u4F20\u5931\u8D25")},R=e=>{l.value.clearFiles(),s.Form.img="",s.Form.img_url="",s.Form.fileList=[]};return I(O({},ie(s)),{editorRef:_,mode:"default",toolbarConfig:g,editorConfig:C,handleCreated:w,uploadRef:l,Ref:t,submitAdd:E,uploadImgServer:pe,handleBeforeUpload:z,handleUrlSuccess:h,handleUrlError:U,handleRemove:R,office_id:V})}},be={style:{float:"right",height:"150px","align-items":"center",display:"flex","font-size":"36px","letter-spacing":"0.2em",color:"#fff"}},Fe={key:0},ve=p("\u4E09\u6C5F\u540D\u533B\u5DE5\u4F5C\u5BA4"),ye=p("\u79D1\u5BA4\u8BBE\u7F6E"),ke=p("\u79D1\u5BA4\u533B\u751F"),Ve=p("\u64C5\u957F\u680F\u7684\u5185\u5BB9\u4E5F\u9700\u8981\u5199\u5230\u533B\u751F\u4ECB\u7ECD\u5185\u5BB9\u91CC(\u5C55\u793A\u7684\u65F6\u5019\u64C5\u957F\u680F\u586B\u5199\u7684\u4E0D\u4F1A\u5355\u72EC\u5C55\u793A)"),Ce=["src"],we={class:"el-upload-list__item-actions"},xe={style:{border:"1px solid #ccc","z-index":"100"}},Ee=p("\u5DF2\u5BA1\u6838"),ze=p("\u5F85\u5BA1\u6838");function Ue(t,l,m,i,f,V){const s=r("el-col"),_=r("el-row"),g=r("el-breadcrumb-item"),C=r("el-breadcrumb"),w=r("el-descriptions-item"),x=r("el-descriptions"),E=r("el-divider"),z=r("plus"),h=r("el-icon"),U=r("delete"),R=r("el-upload"),e=r("el-form-item"),n=r("el-input"),d=r("el-option"),b=r("el-select"),H=r("Toolbar"),L=r("Editor"),j=r("el-radio"),K=r("el-radio-group"),G=r("el-button"),P=r("el-form"),J=r("el-card");return F(),v(de,null,[o(_,{justify:"center",align:"middle",style:{background:"linear-gradient(135deg, rgb(36 205 103 / 95%) 0%, rgb(56 150 226 / 95%) 100% )","margin-bottom":"20px","margin-top":"-10px"}},{default:a(()=>[o(s,{span:24},{default:a(()=>[y("div",be,[t.res_data.office?(F(),v("strong",Fe,D(t.res_data.office.office_name),1)):S("",!0)])]),_:1})]),_:1}),o(C,{separator:"/",style:{"margin-bottom":"20px"}},{default:a(()=>[o(g,{to:{path:"/"}},{default:a(()=>[ve]),_:1}),o(g,{to:{path:"/kssz",query:{id:i.office_id}}},{default:a(()=>[ye]),_:1},8,["to"]),o(g,null,{default:a(()=>[ke]),_:1})]),_:1}),o(J,{style:{"min-height":"100%"}},{default:a(()=>[o(x,{title:"\u63D0\u793A"},{default:a(()=>[o(w,null,{default:a(()=>[Ve]),_:1})]),_:1}),o(E),o(P,{model:t.Form,rules:t.rules,ref:"Ref","label-width":"100px"},{default:a(()=>[o(e,{label:"\u56FE\u7247",prop:"img"},{default:a(()=>[o(R,{ref:"uploadRef",action:i.uploadImgServer,data:{basket:"img"},limit:1,"list-type":"picture-card","thumbnail-mode":"true",headers:{Authorization:t.token},"before-upload":i.handleBeforeUpload,"on-success":i.handleUrlSuccess,"on-error":i.handleUrlError,"auto-upload":!0,"file-list":t.Form.fileList},{default:a(()=>[o(h,null,{default:a(()=>[o(z)]),_:1})]),file:a(({file:u})=>[y("div",null,[t.Form.img_url?(F(),v("img",{key:0,class:"el-upload-list__item-thumbnail",src:t.Form.img_url,alt:""},null,8,Ce)):S("",!0),y("span",we,[t.Form.disabled?(F(),v("span",{key:0,class:"el-upload-list__item-delete",onClick:l[0]||(l[0]=(...Q)=>i.handleRemove&&i.handleRemove(...Q))},[o(h,null,{default:a(()=>[o(U)]),_:1})])):S("",!0)])])]),_:1},8,["action","headers","before-upload","on-success","on-error","file-list"])]),_:1}),o(e,{label:"\u533B\u751F\u540D\u5B57",prop:"name"},{default:a(()=>[o(n,{modelValue:t.Form.name,"onUpdate:modelValue":l[1]||(l[1]=u=>t.Form.name=u),placeholder:"\u8BF7\u8F93\u5165\u533B\u751F\u540D\u5B57",type:"text"},null,8,["modelValue"])]),_:1}),o(e,{label:"\u804C\u79F0",prop:"professional"},{default:a(()=>[o(b,{modelValue:t.Form.professional,"onUpdate:modelValue":l[2]||(l[2]=u=>t.Form.professional=u),placeholder:"Select",filterable:""},{default:a(()=>[o(d,{value:"\u4E3B\u4EFB\u533B\u5E08",label:"\u4E3B\u4EFB\u533B\u5E08"}),o(d,{value:"\u526F\u4E3B\u4EFB\u533B\u5E08",label:"\u526F\u4E3B\u4EFB\u533B\u5E08"}),o(d,{value:"\u4E3B\u6CBB\u533B\u5E08",label:"\u4E3B\u6CBB\u533B\u5E08"}),o(d,{value:"\u533B\u5E08",label:"\u533B\u5E08"}),o(d,{value:"",label:"\u65E0"})]),_:1},8,["modelValue"])]),_:1}),o(e,{label:"\u64C5\u957F",prop:"excel"},{default:a(()=>[o(n,{modelValue:t.Form.excel,"onUpdate:modelValue":l[3]||(l[3]=u=>t.Form.excel=u),placeholder:"\u8BF7\u8F93\u5165\u64C5\u957F",type:"text"},null,8,["modelValue"])]),_:1}),o(e,{label:"\u533B\u751F\u4ECB\u7ECD",prop:"content"},{default:a(()=>[y("div",xe,[o(H,{style:{"border-bottom":"1px solid #ccc"},editor:i.editorRef,defaultConfig:i.toolbarConfig,mode:i.mode},null,8,["editor","defaultConfig","mode"]),o(L,{style:{height:"500px","overflow-y":"hidden"},modelValue:t.Form.content,"onUpdate:modelValue":l[4]||(l[4]=u=>t.Form.content=u),defaultConfig:i.editorConfig,mode:i.mode,onOnCreated:i.handleCreated},null,8,["modelValue","defaultConfig","mode","onOnCreated"])])]),_:1}),o(e,{label:"\u6392\u5E8F",prop:"sort"},{default:a(()=>[o(n,{modelValue:t.Form.sort,"onUpdate:modelValue":l[5]||(l[5]=u=>t.Form.sort=u),placeholder:"\u8BF7\u8F93\u5165\u6392\u5E8F",type:"number"},null,8,["modelValue"])]),_:1}),o(e,{label:"\u72B6\u6001",prop:"status"},{default:a(()=>[o(K,{modelValue:t.Form.status,"onUpdate:modelValue":l[6]||(l[6]=u=>t.Form.status=u),disabled:""},{default:a(()=>[o(j,{label:"1"},{default:a(()=>[Ee]),_:1}),o(j,{label:"0"},{default:a(()=>[ze]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(e,null,{default:a(()=>[o(G,{type:"primary",onClick:l[7]||(l[7]=u=>i.submitAdd())},{default:a(()=>[p(D(t.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})],64)}var je=fe(he,[["render",Ue]]);export{je as default};

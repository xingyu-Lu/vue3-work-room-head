var E=Object.defineProperty,G=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var L=(o,e,g)=>e in o?E(o,e,{enumerable:!0,configurable:!0,writable:!0,value:g}):o[e]=g,B=(o,e)=>{for(var g in e||(e={}))M.call(e,g)&&L(o,g,e[g]);if(j)for(var g of j(e))H.call(e,g)&&L(o,g,e[g]);return o},A=(o,e)=>G(o,z(e));import{ad as q,ao as O,ay as W,r as N,al as T,u as J,a as K,o as Q,ap as X,t as Y,c as u,d as D,e as Z,w as s,ak as h,f as a,an as S,az as V,h as m,ae as $,g as x,i as w,ah as oo,ai as eo,aj as lo}from"./vendor.1fa6d093.js";import{W as ao}from"./wangEditor.28ff08d1.js";import{a as v}from"./axios.1fe8d858.js";import{_ as to,d as so,l as no,u as ro}from"./index.ed178227.js";const go={name:"AddGood",components:{Plus:q,Delete:O},setup(){W();const o=N(null),e=N(null),g=N(null),p=T(),U=J(),{id:f}=p.query,l=K({checkedNames:[1,2],disabled:!1,uploadImgServer:so,token:no("token")||"",id:f,defaultCate:"\u8BF7\u9009\u62E9",goodForm:{goodsName:"",goodsIntro:"",originalPrice:"",sellingPrice:"",stockNum:"",goodsSellStatus:"0",goodsCoverImg:"",tag:"",fileList:[]},categoryId:"",category:{lazy:!0,lazyLoad(r,t){const{level:i,value:b}=r;v.get("/categories.php",{params:{categoryLevel:i+1,parentId:b||0}}).then(y=>{const F=y.list.map(R=>({value:R.categoryId,label:R.categoryName,leaf:i>=1}));t(F)})}}});let n;Q(()=>{n=new ao(e.value),n.config.showLinkImg=!1,n.config.showLinkImgAlt=!1,n.config.showLinkImgHref=!1,n.config.uploadImgMaxSize=2*1024*1024,n.config.uploadFileName="file",n.config.uploadImgHeaders={token:l.token},n.config.uploadImgHooks={customInsert:function(r,t){console.log("result",t),t.data&&t.data.length&&t.data.forEach(i=>r(i))}},n.config.uploadImgServer=ro,Object.assign(n.config,{onchange(){console.log("change")}}),n.create(),f&&v.get("/good_info.php",{params:{id:f}}).then(r=>{const{goods:t,firstCategory:i,secondCategory:b,thirdCategory:y}=r;l.goodForm={goodsName:t.goodsName,goodsIntro:t.goodsIntro,originalPrice:t.originalPrice,sellingPrice:t.sellingPrice,stockNum:t.stockNum,goodsSellStatus:String(t.goodsSellStatus),goodsCoverImg:t.goodsCoverImg,tag:t.tag,categoryId:t.goodsCategoryId,fileList:[{url:t.goodsCoverImg}]},l.categoryId=t.goodsCategoryId,n&&n.txt.html(t.goodsDetailContent)})}),X(()=>{n.destroy(),n=null});const c=()=>{g.value.validate(r=>{if(r){let t=v.post,i={goodsCategoryId:l.categoryId,goodsCoverImg:l.goodForm.goodsCoverImg,goodsDetailContent:n.txt.html(),goodsIntro:l.goodForm.goodsIntro,goodsName:l.goodForm.goodsName,goodsSellStatus:l.goodForm.goodsSellStatus,originalPrice:l.goodForm.originalPrice,sellingPrice:l.goodForm.sellingPrice,stockNum:l.goodForm.stockNum,tag:l.goodForm.tag};if(i.goodsName.length>128){h.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");return}if(i.goodsIntro.length>200){h.error("\u5546\u54C1\u7B80\u4ECB\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26");return}if(i.tag.length>16){h.error("\u5546\u54C1\u6807\u7B7E\u4E0D\u80FD\u8D85\u8FC716\u4E2A\u5B57\u7B26");return}console.log("params",i),f&&(i.goodsId=f,t=v.put),t("/good",i).then(()=>{h.success(f?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),U.push({path:"/good"})})}})},_=r=>{const t=r.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(t))return h.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},k=r=>{l.goodForm.goodsCoverImg=r.data||""},C=r=>{l.categoryId=r[1]||0},I=r=>{o.value.clearFiles(),l.goodForm.goodsCoverImg=""};return A(B({},Y(l)),{uploadRef:o,goodRef:g,submitAdd:c,handleBeforeUpload:_,handleUrlSuccess:k,editor:e,handleChangeCate:C,handleRemove:I})}},P=o=>(eo("data-v-44be946f"),o=o(),lo(),o),io=P(()=>m("label",{for:"runoob"},"Runoob",-1)),uo=P(()=>m("label",{for:"google"},"Google",-1)),mo=P(()=>m("label",{for:"taobao"},"taobao",-1)),po=w("\u4E0A\u67B6"),co=w("\u4E0B\u67B6"),fo=["src"],ho={class:"el-upload-list__item-actions"},_o={ref:"editor"};function Io(o,e,g,p,U,f){const l=u("el-form-item"),n=u("el-cascader"),c=u("el-input"),_=u("el-radio"),k=u("el-radio-group"),C=u("plus"),I=u("el-icon"),r=u("delete"),t=u("el-upload"),i=u("el-button"),b=u("el-form"),y=u("el-card");return D(),Z(y,null,{default:s(()=>[a(b,{model:o.goodForm,rules:o.rules,ref:"goodRef","label-width":"100px",class:"goodForm"},{default:s(()=>[a(l,{label:"\u590D\u9009\u6846"},{default:s(()=>[a(l,null,{default:s(()=>[S(m("input",{type:"checkbox",id:"runoob",value:"1","onUpdate:modelValue":e[0]||(e[0]=d=>o.checkedNames=d)},null,512),[[V,o.checkedNames]]),io,S(m("input",{type:"checkbox",id:"google",value:"2","onUpdate:modelValue":e[1]||(e[1]=d=>o.checkedNames=d)},null,512),[[V,o.checkedNames]]),uo,S(m("input",{type:"checkbox",id:"taobao",value:"3","onUpdate:modelValue":e[2]||(e[2]=d=>o.checkedNames=d)},null,512),[[V,o.checkedNames]]),mo]),_:1})]),_:1}),a(l,{required:"",label:"\u5546\u54C1\u5206\u7C7B"},{default:s(()=>[a(n,{placeholder:o.defaultCate,style:{width:"300px"},props:o.category,onChange:p.handleChangeCate},null,8,["placeholder","props","onChange"])]),_:1}),a(l,{label:"\u5546\u54C1\u540D\u79F0",prop:"goodsName"},{default:s(()=>[a(c,{style:{width:"300px"},modelValue:o.goodForm.goodsName,"onUpdate:modelValue":e[3]||(e[3]=d=>o.goodForm.goodsName=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u7B80\u4ECB",prop:"goodsIntro"},{default:s(()=>[a(c,{style:{width:"300px"},type:"textarea",modelValue:o.goodForm.goodsIntro,"onUpdate:modelValue":e[4]||(e[4]=d=>o.goodForm.goodsIntro=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u7B80\u4ECB(100\u5B57)"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u4EF7\u683C",prop:"originalPrice"},{default:s(()=>[a(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.originalPrice,"onUpdate:modelValue":e[5]||(e[5]=d=>o.goodForm.originalPrice=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u552E\u5356\u4EF7",prop:"sellingPrice"},{default:s(()=>[a(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.sellingPrice,"onUpdate:modelValue":e[6]||(e[6]=d=>o.goodForm.sellingPrice=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u552E\u4EF7"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u5E93\u5B58",prop:"stockNum"},{default:s(()=>[a(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.stockNum,"onUpdate:modelValue":e[7]||(e[7]=d=>o.goodForm.stockNum=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5E93\u5B58"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u6807\u7B7E",prop:"tag"},{default:s(()=>[a(c,{style:{width:"300px"},modelValue:o.goodForm.tag,"onUpdate:modelValue":e[8]||(e[8]=d=>o.goodForm.tag=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5C0F\u6807\u7B7E"},null,8,["modelValue"])]),_:1}),a(l,{label:"\u4E0A\u67B6\u72B6\u6001",prop:"goodsSellStatus"},{default:s(()=>[a(k,{modelValue:o.goodForm.goodsSellStatus,"onUpdate:modelValue":e[9]||(e[9]=d=>o.goodForm.goodsSellStatus=d)},{default:s(()=>[a(_,{label:"0"},{default:s(()=>[po]),_:1}),a(_,{label:"1"},{default:s(()=>[co]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(l,{label:"\u5546\u54C1\u4E3B\u56FE",prop:"goodsCoverImg"},{default:s(()=>[a(t,{ref:"uploadRef",action:o.uploadImgServer,limit:2,"list-type":"picture-card","thumbnail-mode":"true",headers:{token:o.token},"before-upload":p.handleBeforeUpload,"on-success":p.handleUrlSuccess,"auto-upload":!0,"file-list":o.goodForm.fileList},{default:s(()=>[a(I,null,{default:s(()=>[a(C)]),_:1})]),file:s(({file:d})=>[m("div",null,[m("img",{class:"el-upload-list__item-thumbnail",src:d.url,alt:""},null,8,fo),m("span",ho,[o.disabled?x("",!0):(D(),$("span",{key:0,class:"el-upload-list__item-delete",onClick:e[10]||(e[10]=(...F)=>p.handleRemove&&p.handleRemove(...F))},[a(I,null,{default:s(()=>[a(r)]),_:1})]))])])]),_:1},8,["action","headers","before-upload","on-success","file-list"])]),_:1}),a(l,{label:"\u8BE6\u60C5\u5185\u5BB9"},{default:s(()=>[m("div",_o,null,512)]),_:1}),a(l,null,{default:s(()=>[a(i,{type:"primary",onClick:e[11]||(e[11]=d=>p.submitAdd())},{default:s(()=>[w(oo(o.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}var Fo=to(go,[["render",Io],["__scopeId","data-v-44be946f"]]);export{Fo as default};
